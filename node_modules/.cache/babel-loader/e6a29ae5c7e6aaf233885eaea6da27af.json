{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/evan_/Documents/GitHub/picshare/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/evan_/Documents/GitHub/picshare/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"C:/Users/evan_/Documents/GitHub/picshare/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/evan_/Documents/GitHub/picshare/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{GoogleMap,useLoadScript,Marker,InfoWindow}from\"@react-google-maps/api\";import{formatRelative}from\"date-fns\";import usePlacesAutocomplete,{getGeocode,getLatLng}from\"use-places-autocomplete\";import{Combobox,ComboboxInput,ComboboxPopover,ComboboxList,ComboboxOption}from\"@reach/combobox\";import\"./explore.css\";import{NONAME}from\"dns\";import Axios from'axios';import Navbar from'./components/Navbar/NavBar';import SideDrawer from'./components/SideDrawer/SideDrawer';import Backdrop from'./components/Backdrop/Backdrop';//credintials for get, using axios\nAxios.defaults.withCredentials=true;var libraries=[\"places\"];var mapContainerStyle={// set width/height of the map container\nwidth:'100vw',height:'100vh'};var center={// set initial position of map\nlat:55.909549,lng:-3.318807};var options={disableDefaultUI:true,zoomControl:true};export default function Explore(){var _useLoadScript=useLoadScript({googleMapsApiKey:\"AIzaSyAhlnlgHa_2GfJVSbupAcK_aIMxlc7DSoI\",// api key stored in .env.local file\nlibraries:libraries}),isLoaded=_useLoadScript.isLoaded,loadError=_useLoadScript.loadError;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),markers=_React$useState2[0],setMarkers=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),selected=_React$useState4[0],setSelected=_React$useState4[1];var _React$useState5=React.useState(null),_React$useState6=_slicedToArray(_React$useState5,2),sideDrawer=_React$useState6[0],setSideDrawer=_React$useState6[1];var _React$useState7=React.useState(null),_React$useState8=_slicedToArray(_React$useState7,2),backDrop=_React$useState8[0],setBackDrop=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),sideDrawerOpen=_React$useState10[0],setSideDrawerOpen=_React$useState10[1];var drawerToggleClick=function drawerToggleClick(){console.log(sideDrawerOpen);setSideDrawerOpen(!sideDrawerOpen);};var backdropClick=function backdropClick(){setSideDrawerOpen(false);};var onMapClick=React.useCallback(function(event){// setting event on click of map\nsetMarkers(function(current){return[].concat(_toConsumableArray(current),[{lat:event.latLng.lat(),lng:event.latLng.lng(),time:new Date()}]);});},[]);// stores events in array\nvar mapRef=React.useRef();//keeping track of reference to map so we can pan\nvar onMapLoad=React.useCallback(function(map){mapRef.current=map;},[]);var panTo=React.useCallback(function(_ref){var lat=_ref.lat,lng=_ref.lng;//panning function that takes lat+lng of search selection and pans map to it\nmapRef.current.panTo({lat:lat,lng:lng});mapRef.current.setZoom(14);panTo({lat:lat,lng:lng});},[]);if(loadError)return\"Error loading maps\";if(!isLoaded)return\"Loading Maps\";return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{drawerClickedHandler:drawerToggleClick}),sideDrawerOpen?/*#__PURE__*/_jsx(SideDrawer,{}):null,sideDrawerOpen?/*#__PURE__*/_jsx(Backdrop,{click:backdropClick}):null,/*#__PURE__*/_jsx(Search,{panTo:panTo}),/*#__PURE__*/_jsx(Locate,{panTo:panTo}),/*#__PURE__*/_jsxs(GoogleMap//map info\n,{mapContainerStyle:mapContainerStyle,zoom:15,center:center,options:options,onClick:onMapClick,onLoad:onMapLoad,children:[markers.map(function(marker){return/*#__PURE__*/_jsx(Marker//marker info\n,{position:{lat:marker.lat,lng:marker.lng},onClick:function onClick(){setSelected(marker);}},marker.time.toISOString());}),selected?/*#__PURE__*/_jsx(InfoWindow,{position:{lat:selected.lat,lng:selected.lng},onCloseClick:function onCloseClick(){setSelected(null);},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Example\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Added \",formatRelative(selected.time,new Date())]})]})}):null]})]});}function Locate(_ref2){var panTo=_ref2.panTo;return/*#__PURE__*/_jsx(\"button\",{className:\"Locate\",onClick:function onClick(){navigator.geolocation.getCurrentPosition(function(position){panTo({lat:position.coords.latitude,lng:position.coords.longitude});},function(){return null;});},children:/*#__PURE__*/_jsx(\"img\",{src:\"favicon.ico\",alt:\"locate me\"})});}function Search(_ref3){var panTo=_ref3.panTo;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),response=_useState4[0],setResponse=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),interests=_useState6[0],setInterestList=_useState6[1];var filteredInterest=interests.filter(function(interest){return interest.toLowerCase().includes(searchTerm);});var printInterest=filteredInterest.slice(0,10).map(function(item){return/*#__PURE__*/_jsxs(\"li\",{className:\"mapresult\",children:[item,\", \"]});});var getInterests=function getInterests(){Axios.get('http://localhost:3001/getInterest',{}).then(function(response){setResponse(response);initInterests();});};var initInterests=function initInterests(){setInterestList([]);console.log(response);if(typeof response.data!=='undefined'){for(var i=0;i<response.data.length;i++){setInterestList(function(interests){return[].concat(_toConsumableArray(interests),[response.data[i].InterestsName]);});}}};var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),Userresponse=_useState8[0],setResponseUser=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),users=_useState10[0],setUserList=_useState10[1];var filteredUsers=users.filter(function(user){return user.toLowerCase().includes(searchTerm);});var printUsers=filteredUsers.slice(0,10).map(function(item){return/*#__PURE__*/_jsxs(\"li\",{className:\"mapresult\",children:[\" \",item,\", \"]});});var getUsers=function getUsers(){Axios.get('http://localhost:3001/getUsers',{}).then(function(response){setResponseUser(response);initUsers();});};var initUsers=function initUsers(){setUserList([]);console.log(Userresponse);if(typeof Userresponse.data!=='undefined'){for(var i=0;i<Userresponse.data.length;i++){setUserList(function(users){return[].concat(_toConsumableArray(users),[Userresponse.data[i].Username]);});}}};var _usePlacesAutocomplet=usePlacesAutocomplete({requestOptions:{location:{lat:function lat(){return 55.909549;},lng:function lng(){return-3.318807;}},//setting prefered location suggestions to around HW Campus\nradius:100*1000}}),ready=_usePlacesAutocomplet.ready,value=_usePlacesAutocomplet.value,_usePlacesAutocomplet2=_usePlacesAutocomplet.suggestions,status=_usePlacesAutocomplet2.status,data=_usePlacesAutocomplet2.data,setValue=_usePlacesAutocomplet.setValue,clearSuggestions=_usePlacesAutocomplet.clearSuggestions;return/*#__PURE__*/_jsx(\"div\",{className:\"search\",children:/*#__PURE__*/_jsxs(Combobox,{onSelect:/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(address){var results,_yield$getLatLng,lat,lng;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setValue(address,false);clearSuggestions();_context.prev=2;_context.next=5;return getGeocode({address:address});case 5:results=_context.sent;_context.next=8;return getLatLng(results[0]);case 8:_yield$getLatLng=_context.sent;lat=_yield$getLatLng.lat;lng=_yield$getLatLng.lng;panTo({lat:lat,lng:lng});_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);console.log(\"error!\");case 17:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);}));return function(_x){return _ref4.apply(this,arguments);};}(),children:[/*#__PURE__*/_jsx(ComboboxInput,{value:value,onChange:function onChange(e){getInterests();getUsers();setSearchTerm(e.target.value);setValue(e.target.value);},disabled:!ready,placeholder:\"Enter Address\"}),/*#__PURE__*/_jsx(ComboboxPopover,{className:\"list\",children:/*#__PURE__*/_jsxs(ComboboxList,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"searchTitles\",children:\"Locations\"}),status===\"OK\"&&data.map(function(_ref5){var id=_ref5.id,description=_ref5.description;return/*#__PURE__*/_jsxs(\"ul\",{className:\"searchList\",children:[/*#__PURE__*/_jsx(ComboboxOption,{className:\"mapresult\",value:description},id),\" \"]});}),/*#__PURE__*/_jsx(\"h1\",{className:\"searchTitles\",children:\"Users\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"searchList\",children:[\" \",printUsers,\" \"]}),/*#__PURE__*/_jsx(\"h1\",{className:\"searchTitles\",children:\"Interests\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"searchList\",children:[\" \",printInterest,\" \"]})]})})]})});}","map":{"version":3,"sources":["C:/Users/evan_/Documents/GitHub/picshare/src/explore.js"],"names":["React","useState","useEffect","GoogleMap","useLoadScript","Marker","InfoWindow","formatRelative","usePlacesAutocomplete","getGeocode","getLatLng","Combobox","ComboboxInput","ComboboxPopover","ComboboxList","ComboboxOption","NONAME","Axios","Navbar","SideDrawer","Backdrop","defaults","withCredentials","libraries","mapContainerStyle","width","height","center","lat","lng","options","disableDefaultUI","zoomControl","Explore","googleMapsApiKey","isLoaded","loadError","markers","setMarkers","selected","setSelected","sideDrawer","setSideDrawer","backDrop","setBackDrop","sideDrawerOpen","setSideDrawerOpen","drawerToggleClick","console","log","backdropClick","onMapClick","useCallback","event","current","latLng","time","Date","mapRef","useRef","onMapLoad","map","panTo","setZoom","marker","toISOString","Locate","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","Search","searchTerm","setSearchTerm","response","setResponse","interests","setInterestList","filteredInterest","filter","interest","toLowerCase","includes","printInterest","slice","item","getInterests","get","then","initInterests","data","i","length","InterestsName","Userresponse","setResponseUser","users","setUserList","filteredUsers","user","printUsers","getUsers","initUsers","Username","requestOptions","location","radius","ready","value","suggestions","status","setValue","clearSuggestions","address","results","e","target","id","description"],"mappings":"ytBAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,CAAyBC,SAAzB,KAA+C,OAA/C,CACA,OAASC,SAAT,CAAoBC,aAApB,CAAmCC,MAAnC,CAA2CC,UAA3C,KAA6D,wBAA7D,CACA,OAASC,cAAT,KAA+B,UAA/B,CACA,MAAOC,CAAAA,qBAAP,EAAgCC,UAAhC,CAA4CC,SAA5C,KAA6D,yBAA7D,CACA,OAASC,QAAT,CAAmBC,aAAnB,CAAkCC,eAAlC,CAAmDC,YAAnD,CAAiEC,cAAjE,KAAuF,iBAAvF,CACA,MAAO,eAAP,CACA,OAASC,MAAT,KAAuB,KAAvB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,4BAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,oCAAvB,CACA,MAAOC,CAAAA,QAAP,KAAqB,gCAArB,CACA;AACAH,KAAK,CAACI,QAAN,CAAeC,eAAf,CAAiC,IAAjC,CAKA,GAAMC,CAAAA,SAAS,CAAG,CAAC,QAAD,CAAlB,CACA,GAAMC,CAAAA,iBAAiB,CAAG,CAAE;AAC1BC,KAAK,CAAE,OADiB,CAExBC,MAAM,CAAE,OAFgB,CAA1B,CAIA,GAAMC,CAAAA,MAAM,CAAG,CAAE;AACfC,GAAG,CAAE,SADQ,CAEbC,GAAG,CAAE,CAAC,QAFO,CAAf,CAKA,GAAMC,CAAAA,OAAO,CAAG,CACdC,gBAAgB,CAAE,IADJ,CAEdC,WAAW,CAAE,IAFC,CAAhB,CAKA,cAAe,SAASC,CAAAA,OAAT,EAAmB,oBAKA7B,aAAa,CAAC,CAC5C8B,gBAAgB,CAAE,yCAD0B,CACiB;AAC7DX,SAAS,CAATA,SAF4C,CAAD,CALb,CAKxBY,QALwB,gBAKxBA,QALwB,CAKdC,SALc,gBAKdA,SALc,qBAUFpC,KAAK,CAACC,QAAN,CAAe,EAAf,CAVE,oDAUzBoC,OAVyB,qBAUhBC,UAVgB,0CAWAtC,KAAK,CAACC,QAAN,CAAe,IAAf,CAXA,qDAWzBsC,QAXyB,qBAWfC,WAXe,0CAYIxC,KAAK,CAACC,QAAN,CAAe,IAAf,CAZJ,qDAYzBwC,UAZyB,qBAYbC,aAZa,0CAaA1C,KAAK,CAACC,QAAN,CAAe,IAAf,CAbA,qDAazB0C,QAbyB,qBAafC,WAbe,0CAgBY5C,KAAK,CAACC,QAAN,CAAe,KAAf,CAhBZ,sDAgBzB4C,cAhByB,sBAgBTC,iBAhBS,sBAmBhC,GAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,EAAM,CAC9BC,OAAO,CAACC,GAAR,CAAYJ,cAAZ,EACAC,iBAAiB,CAAC,CAACD,cAAF,CAAjB,CACD,CAHD,CAKA,GAAMK,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACxBJ,iBAAiB,CAAC,KAAD,CAAjB,CACH,CAFD,CAUA,GAAMK,CAAAA,UAAU,CAAGnD,KAAK,CAACoD,WAAN,CAAkB,SAACC,KAAD,CAAW,CAAE;AAChDf,UAAU,CAAC,SAAAgB,OAAO,qCAAQA,OAAR,GAAiB,CACjC1B,GAAG,CAAEyB,KAAK,CAACE,MAAN,CAAa3B,GAAb,EAD4B,CAEjCC,GAAG,CAAEwB,KAAK,CAACE,MAAN,CAAa1B,GAAb,EAF4B,CAGjC2B,IAAI,CAAE,GAAIC,CAAAA,IAAJ,EAH2B,CAAjB,IAAR,CAAV,CAKD,CANkB,CAMhB,EANgB,CAAnB,CAMQ;AAER,GAAMC,CAAAA,MAAM,CAAG1D,KAAK,CAAC2D,MAAN,EAAf,CAA+B;AAC/B,GAAMC,CAAAA,SAAS,CAAG5D,KAAK,CAACoD,WAAN,CAAkB,SAACS,GAAD,CAAS,CAC3CH,MAAM,CAACJ,OAAP,CAAiBO,GAAjB,CACD,CAFiB,CAEf,EAFe,CAAlB,CAIA,GAAMC,CAAAA,KAAK,CAAG9D,KAAK,CAACoD,WAAN,CAAkB,cAAe,IAAbxB,CAAAA,GAAa,MAAbA,GAAa,CAATC,GAAS,MAATA,GAAS,CAAG;AAChD6B,MAAM,CAACJ,OAAP,CAAeQ,KAAf,CAAqB,CAAClC,GAAG,CAAHA,GAAD,CAAKC,GAAG,CAAHA,GAAL,CAArB,EACA6B,MAAM,CAACJ,OAAP,CAAeS,OAAf,CAAuB,EAAvB,EACAD,KAAK,CAAC,CAAClC,GAAG,CAAHA,GAAD,CAAKC,GAAG,CAAHA,GAAL,CAAD,CAAL,CACD,CAJa,CAIX,EAJW,CAAd,CAOA,GAAIO,SAAJ,CAAe,MAAO,oBAAP,CACf,GAAI,CAACD,QAAL,CAAe,MAAO,cAAP,CAGf,mBAIA,oCACG,KAAC,MAAD,EAAQ,oBAAoB,CAAEY,iBAA9B,EADH,CAGKF,cAAc,cACf,KAAC,UAAD,IADe,CAGd,IANL,CAQGA,cAAc,cACT,KAAC,QAAD,EAAU,KAAK,CAAEK,aAAjB,EADS,CAGd,IAXH,cAeE,KAAC,MAAD,EAAQ,KAAK,CAAEY,KAAf,EAfF,cAgBE,KAAC,MAAD,EAAQ,KAAK,CAAEA,KAAf,EAhBF,cAkBE,MAAC,SAAU;AAAX,EACE,iBAAiB,CAAEtC,iBADrB,CAEE,IAAI,CAAE,EAFR,CAGE,MAAM,CAAEG,MAHV,CAIE,OAAO,CAAEG,OAJX,CAKE,OAAO,CAAEqB,UALX,CAME,MAAM,CAAES,SANV,WAQGvB,OAAO,CAACwB,GAAR,CAAY,SAACG,MAAD,qBACX,KAAC,MAAO;AAAR,EAEE,QAAQ,CAAE,CAAEpC,GAAG,CAAEoC,MAAM,CAACpC,GAAd,CAAmBC,GAAG,CAAEmC,MAAM,CAACnC,GAA/B,CAFZ,CAGE,OAAO,CAAE,kBAAM,CACbW,WAAW,CAACwB,MAAD,CAAX,CACD,CALH,EACOA,MAAM,CAACR,IAAP,CAAYS,WAAZ,EADP,CADW,EAAZ,CARH,CAkBG1B,QAAQ,cACP,KAAC,UAAD,EACE,QAAQ,CAAE,CAAEX,GAAG,CAAEW,QAAQ,CAACX,GAAhB,CAAqBC,GAAG,CAAEU,QAAQ,CAACV,GAAnC,CADZ,CAEE,YAAY,CAAE,uBAAM,CAClBW,WAAW,CAAC,IAAD,CAAX,CACD,CAJH,uBAME,oCACE,+BADF,cAEE,8BAAUjC,cAAc,CAACgC,QAAQ,CAACiB,IAAV,CAAgB,GAAIC,CAAAA,IAAJ,EAAhB,CAAxB,GAFF,GANF,EADO,CAWU,IA7BrB,GAlBF,GAJA,CAyDD,CAGD,QAASS,CAAAA,MAAT,OAAyB,IAAPJ,CAAAA,KAAO,OAAPA,KAAO,CACvB,mBAAO,eAAQ,SAAS,CAAC,QAAlB,CAA2B,OAAO,CAAE,kBAAM,CAC/CK,SAAS,CAACC,WAAV,CAAsBC,kBAAtB,CAAyC,SAACC,QAAD,CAAc,CACrDR,KAAK,CAAC,CACJlC,GAAG,CAAE0C,QAAQ,CAACC,MAAT,CAAgBC,QADjB,CAEJ3C,GAAG,CAAEyC,QAAQ,CAACC,MAAT,CAAgBE,SAFjB,CAAD,CAAL,CAID,CALD,CAKG,iBAAM,KAAN,EALH,EAMD,CAPM,uBAQL,YAAK,GAAG,CAAC,aAAT,CAAuB,GAAG,CAAC,WAA3B,EARK,EAAP,CAUD,CAID,QAASC,CAAAA,MAAT,OAAyB,IAARZ,CAAAA,KAAQ,OAARA,KAAQ,eAKa7D,QAAQ,CAAC,EAAD,CALrB,wCAKhB0E,UALgB,eAKJC,aALI,8BAMS3E,QAAQ,CAAC,EAAD,CANjB,yCAMhB4E,QANgB,eAMNC,WANM,8BAOc7E,QAAQ,CAAC,EAAD,CAPtB,yCAOhB8E,SAPgB,eAOLC,eAPK,eASvB,GAAMC,CAAAA,gBAAgB,CACdF,SAAS,CAACG,MAAV,CAAiB,SAAAC,QAAQ,CAAI,CAC7B,MAAOA,CAAAA,QAAQ,CAACC,WAAT,GAAuBC,QAAvB,CAAgCV,UAAhC,CAAP,CACH,CAFG,CADR,CAKA,GAAMW,CAAAA,aAAa,CAEjBL,gBAAgB,CAACM,KAAjB,CAAuB,CAAvB,CAAyB,EAAzB,EAA6B1B,GAA7B,CAAiC,SAAC2B,IAAD,qBACjC,YAAI,SAAS,CAAC,WAAd,WAA4BA,IAA5B,QADiC,EAAjC,CAFF,CAUA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzBxE,KAAK,CAACyE,GAAN,CAAU,mCAAV,CAA+C,EAA/C,EAEGC,IAFH,CAEQ,SAACd,QAAD,CAAc,CAClBC,WAAW,CAACD,QAAD,CAAX,CAEAe,aAAa,GAEhB,CAPD,EAQD,CATD,CAaA,GAAMA,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1BZ,eAAe,CAAC,EAAD,CAAf,CACAhC,OAAO,CAACC,GAAR,CAAY4B,QAAZ,EACA,GAAG,MAAOA,CAAAA,QAAQ,CAACgB,IAAhB,GAAyB,WAA5B,CAAwC,CACpC,IAAI,GAAIC,CAAAA,CAAC,CAAG,CAAZ,CAAeA,CAAC,CAAGjB,QAAQ,CAACgB,IAAT,CAAcE,MAAjC,CAAyCD,CAAC,EAA1C,CAA6C,CACzCd,eAAe,CAAC,SAAAD,SAAS,qCAAQA,SAAR,GAAkBF,QAAQ,CAACgB,IAAT,CAAcC,CAAd,EAAiBE,aAAnC,IAAV,CAAf,CACH,CACJ,CAEF,CATD,CArCuB,eAkDiB/F,QAAQ,CAAC,EAAD,CAlDzB,yCAkDhBgG,YAlDgB,eAkDFC,eAlDE,8BAmDMjG,QAAQ,CAAC,EAAD,CAnDd,0CAmDhBkG,KAnDgB,gBAmDTC,WAnDS,gBAqDvB,GAAMC,CAAAA,aAAa,CAEXF,KAAK,CAACjB,MAAN,CAAa,SAAAoB,IAAI,CAAI,CACrB,MAAOA,CAAAA,IAAI,CAAClB,WAAL,GAAmBC,QAAnB,CAA4BV,UAA5B,CAAP,CACH,CAFG,CAFR,CAMA,GAAM4B,CAAAA,UAAU,CAAIF,aAAa,CAACd,KAAd,CAAoB,CAApB,CAAsB,EAAtB,EAA0B1B,GAA1B,CAA8B,SAAC2B,IAAD,qBAClD,YAAI,SAAS,CAAC,WAAd,eAA6BA,IAA7B,QADkD,EAA9B,CAApB,CAKA,GAAMgB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACrBvF,KAAK,CAACyE,GAAN,CAAU,gCAAV,CAA4C,EAA5C,EAEGC,IAFH,CAEQ,SAACd,QAAD,CAAc,CAClBqB,eAAe,CAACrB,QAAD,CAAf,CAEA4B,SAAS,GAEZ,CAPD,EAQD,CATD,CAaA,GAAMA,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtBL,WAAW,CAAC,EAAD,CAAX,CACApD,OAAO,CAACC,GAAR,CAAYgD,YAAZ,EACA,GAAG,MAAOA,CAAAA,YAAY,CAACJ,IAApB,GAA6B,WAAhC,CAA4C,CACxC,IAAI,GAAIC,CAAAA,CAAC,CAAG,CAAZ,CAAeA,CAAC,CAAGG,YAAY,CAACJ,IAAb,CAAkBE,MAArC,CAA6CD,CAAC,EAA9C,CAAiD,CAC7CM,WAAW,CAAC,SAAAD,KAAK,qCAAQA,KAAR,GAAcF,YAAY,CAACJ,IAAb,CAAkBC,CAAlB,EAAqBY,QAAnC,IAAN,CAAX,CACH,CACJ,CAEF,CATD,CA7EuB,0BAsG6DlG,qBAAqB,CAAC,CACxGmG,cAAc,CAAE,CACdC,QAAQ,CAAE,CAAEhF,GAAG,CAAE,qBAAM,UAAN,EAAP,CAAwBC,GAAG,CAAE,qBAAM,CAAC,QAAP,EAA7B,CADI,CAC8C;AAC5DgF,MAAM,CAAE,IAAM,IAFA,CADwF,CAAD,CAtGlF,CAsGfC,KAtGe,uBAsGfA,KAtGe,CAsGRC,KAtGQ,uBAsGRA,KAtGQ,8CAsGDC,WAtGC,CAsGcC,MAtGd,wBAsGcA,MAtGd,CAsGsBpB,IAtGtB,wBAsGsBA,IAtGtB,CAsG8BqB,QAtG9B,uBAsG8BA,QAtG9B,CAsGwCC,gBAtGxC,uBAsGwCA,gBAtGxC,CA+GvB,mBAGE,YAAK,SAAS,CAAC,QAAf,uBACE,MAAC,QAAD,EAAU,QAAQ,2FAAE,iBAAOC,OAAP,uJAClBF,QAAQ,CAACE,OAAD,CAAU,KAAV,CAAR,CACAD,gBAAgB,GAFE,sCAKM1G,CAAAA,UAAU,CAAC,CAAC2G,OAAO,CAAPA,OAAD,CAAD,CALhB,QAKVC,OALU,qCAMS3G,CAAAA,SAAS,CAAC2G,OAAO,CAAC,CAAD,CAAR,CANlB,uCAMTzF,GANS,kBAMTA,GANS,CAMJC,GANI,kBAMJA,GANI,CAOhBiC,KAAK,CAAC,CAAClC,GAAG,CAAHA,GAAD,CAAMC,GAAG,CAAHA,GAAN,CAAD,CAAL,CAPgB,iFAShBmB,OAAO,CAACC,GAAR,CAAY,QAAZ,EATgB,qEAAF,+DAAlB,wBAaE,KAAC,aAAD,EAAe,KAAK,CAAE8D,KAAtB,CAA6B,QAAQ,CAAE,kBAACO,CAAD,CAAO,CAC5C7B,YAAY,GACZe,QAAQ,GACR5B,aAAa,CAAC0C,CAAC,CAACC,MAAF,CAASR,KAAV,CAAb,CACAG,QAAQ,CAACI,CAAC,CAACC,MAAF,CAASR,KAAV,CAAR,CACD,CALD,CAME,QAAQ,CAAE,CAACD,KANb,CAOE,WAAW,CAAC,eAPd,EAbF,cAsBE,KAAC,eAAD,EAAiB,SAAS,CAAC,MAA3B,uBACA,MAAC,YAAD,yBACE,WAAI,SAAS,CAAC,cAAd,uBADF,CAEKG,MAAM,GAAK,IAAX,EACCpB,IAAI,CAAChC,GAAL,CAAS,mBAAE2D,CAAAA,EAAF,OAAEA,EAAF,CAAMC,WAAN,OAAMA,WAAN,oBAAwB,YAAI,SAAS,CAAC,YAAd,wBAA2B,KAAC,cAAD,EAAgB,SAAS,CAAC,WAA1B,CAA+C,KAAK,CAAEA,WAAtD,EAA2CD,EAA3C,CAA3B,OAAxB,EAAT,CAHN,cAKE,WAAI,SAAS,CAAC,cAAd,mBALF,cAME,YAAI,SAAS,CAAC,YAAd,eAA6BjB,UAA7B,OANF,cAOE,WAAI,SAAS,CAAC,cAAd,uBAPF,cAQE,YAAI,SAAS,CAAC,YAAd,eAA6BjB,aAA7B,OARF,GADA,EAtBF,GADF,EAHF,CAyCD","sourcesContent":["import React, {useState, useEffect}       from 'react';\r\nimport { GoogleMap, useLoadScript, Marker, InfoWindow } from \"@react-google-maps/api\";\r\nimport { formatRelative } from \"date-fns\";\r\nimport usePlacesAutocomplete, { getGeocode, getLatLng } from \"use-places-autocomplete\";\r\nimport { Combobox, ComboboxInput, ComboboxPopover, ComboboxList, ComboboxOption } from \"@reach/combobox\";\r\nimport \"./explore.css\"\r\nimport { NONAME } from \"dns\";\r\nimport Axios from 'axios';\r\nimport Navbar from './components/Navbar/NavBar';\r\nimport SideDrawer from './components/SideDrawer/SideDrawer';\r\nimport Backdrop from './components/Backdrop/Backdrop'\r\n//credintials for get, using axios\r\nAxios.defaults.withCredentials = true;\r\n\r\n\r\n\r\n\r\nconst libraries = [\"places\"];\r\nconst mapContainerStyle = { // set width/height of the map container\r\n  width: '100vw',\r\n  height: '100vh',\r\n};\r\nconst center = { // set initial position of map\r\n  lat: 55.909549,\r\n  lng: -3.318807,\r\n};\r\n\r\nconst options = {\r\n  disableDefaultUI: true,\r\n  zoomControl: true,\r\n}\r\n\r\nexport default function Explore() {\r\n\r\n\r\n\r\n\r\n  const { isLoaded, loadError } = useLoadScript({\r\n    googleMapsApiKey: \"AIzaSyAhlnlgHa_2GfJVSbupAcK_aIMxlc7DSoI\", // api key stored in .env.local file\r\n    libraries,\r\n  });\r\n\r\n  const [markers, setMarkers] = React.useState([]);\r\n  const [selected, setSelected] = React.useState(null);\r\n  const [sideDrawer, setSideDrawer] = React.useState(null);\r\n  const [backDrop, setBackDrop] = React.useState(null);\r\n\r\n\r\n  const [sideDrawerOpen, setSideDrawerOpen] = React.useState(false)\r\n\r\n\r\n  const drawerToggleClick = () => {\r\n    console.log(sideDrawerOpen)\r\n    setSideDrawerOpen(!sideDrawerOpen);\r\n  };\r\n\r\n  const backdropClick = () => {\r\n      setSideDrawerOpen(false)\r\n  };\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const onMapClick = React.useCallback((event) => { // setting event on click of map\r\n    setMarkers(current => [...current, {\r\n      lat: event.latLng.lat(),\r\n      lng: event.latLng.lng(),\r\n      time: new Date(),\r\n    }])\r\n  }, []); // stores events in array\r\n\r\n  const mapRef = React.useRef(); //keeping track of reference to map so we can pan\r\n  const onMapLoad = React.useCallback((map) => {\r\n    mapRef.current = map;\r\n  }, []);\r\n\r\n  const panTo = React.useCallback(({lat,lng}) => {  //panning function that takes lat+lng of search selection and pans map to it\r\n    mapRef.current.panTo({lat,lng});\r\n    mapRef.current.setZoom(14);\r\n    panTo({lat,lng});\r\n  }, []);\r\n\r\n\r\n  if (loadError) return \"Error loading maps\";\r\n  if (!isLoaded) return \"Loading Maps\";\r\n\r\n\r\n  return (\r\n\r\n\r\n\r\n  <div>\r\n     <Navbar drawerClickedHandler={drawerToggleClick} />\r\n\r\n      {sideDrawerOpen?\r\n      <SideDrawer />\r\n\r\n      :null }\r\n\r\n    {sideDrawerOpen?\r\n          <Backdrop click={backdropClick} />\r\n\r\n    :null }\r\n\r\n\r\n\r\n    <Search panTo={panTo} />\r\n    <Locate panTo={panTo} />\r\n\r\n    <GoogleMap //map info\r\n      mapContainerStyle={mapContainerStyle}\r\n      zoom={15}\r\n      center={center}\r\n      options={options}\r\n      onClick={onMapClick}\r\n      onLoad={onMapLoad}\r\n    >\r\n      {markers.map((marker) => (\r\n        <Marker //marker info\r\n          key={marker.time.toISOString()}\r\n          position={{ lat: marker.lat, lng: marker.lng }}\r\n          onClick={() => {\r\n            setSelected(marker);\r\n          }}\r\n        />\r\n      ))}\r\n\r\n      {selected ? (\r\n        <InfoWindow\r\n          position={{ lat: selected.lat, lng: selected.lng }}\r\n          onCloseClick={() => {\r\n            setSelected(null);\r\n          }}\r\n        >\r\n          <div>\r\n            <h2>Example</h2>\r\n            <p>Added {formatRelative(selected.time, new Date())}</p>\r\n          </div>\r\n        </InfoWindow>) : null}\r\n\r\n\r\n    </GoogleMap>\r\n  </div>\r\n  );\r\n}\r\n\r\n\r\nfunction Locate ({panTo}){\r\n  return <button className=\"Locate\" onClick={() => {\r\n    navigator.geolocation.getCurrentPosition((position) => {\r\n      panTo({\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude,\r\n      });\r\n    }, () => null);\r\n  }}>\r\n    <img src=\"favicon.ico\" alt=\"locate me\"/>\r\n    </button>\r\n}\r\n\r\n\r\n\r\nfunction Search({panTo}) {\r\n\r\n\r\n\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [response, setResponse] = useState([]);\r\n  const [interests, setInterestList] = useState([]);\r\n\r\n  const filteredInterest =\r\n          interests.filter(interest => {\r\n          return interest.toLowerCase().includes(searchTerm);\r\n      })\r\n\r\n  const printInterest =\r\n\r\n    filteredInterest.slice(0,10).map((item) =>\r\n    <li className=\"mapresult\" >{item}, </li>\r\n\r\n  );\r\n\r\n\r\n\r\n\r\n  const getInterests = () => {\r\n    Axios.get('http://localhost:3001/getInterest', {\r\n\r\n    }).then((response) => {\r\n        setResponse(response);\r\n\r\n        initInterests();\r\n\r\n    })\r\n  }\r\n\r\n\r\n\r\n  const initInterests = () => {\r\n    setInterestList([]);\r\n    console.log(response)\r\n    if(typeof response.data !== 'undefined'){\r\n        for(var i = 0; i < response.data.length; i++){\r\n            setInterestList(interests => [...interests,response.data[i].InterestsName])\r\n        }\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  const [Userresponse, setResponseUser] = useState([]);\r\n  const [users, setUserList] = useState([]);\r\n\r\n  const filteredUsers =\r\n\r\n          users.filter(user => {\r\n          return user.toLowerCase().includes(searchTerm);\r\n      })\r\n\r\n  const printUsers =  filteredUsers.slice(0,10).map((item) =>\r\n  <li className=\"mapresult\" > {item}, </li>\r\n\r\n  );\r\n\r\n  const getUsers = () => {\r\n    Axios.get('http://localhost:3001/getUsers', {\r\n\r\n    }).then((response) => {\r\n        setResponseUser(response);\r\n\r\n        initUsers();\r\n\r\n    })\r\n  }\r\n\r\n\r\n\r\n  const initUsers = () => {\r\n    setUserList([]);\r\n    console.log(Userresponse)\r\n    if(typeof Userresponse.data !== 'undefined'){\r\n        for(var i = 0; i < Userresponse.data.length; i++){\r\n            setUserList(users => [...users,Userresponse.data[i].Username])\r\n        }\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const { ready, value, suggestions: { status, data }, setValue, clearSuggestions } = usePlacesAutocomplete({\r\n    requestOptions: {\r\n      location: { lat: () => 55.909549, lng: () => -3.318807 },   //setting prefered location suggestions to around HW Campus\r\n      radius: 100 * 1000,\r\n    },\r\n  });\r\n\r\n\r\n\r\n  return (\r\n\r\n\r\n    <div className=\"search\">\r\n      <Combobox onSelect={async (address) => {\r\n        setValue(address, false);\r\n        clearSuggestions();\r\n\r\n        try {   //awaiting a selection to then get its lat+lng for panning\r\n          const results = await getGeocode({address});\r\n          const {lat, lng} = await getLatLng(results[0]);\r\n          panTo({lat, lng});\r\n        } catch(error){\r\n          console.log(\"error!\")\r\n        }\r\n        }}\r\n        >\r\n        <ComboboxInput value={value} onChange={(e) => {\r\n          getInterests();\r\n          getUsers();\r\n          setSearchTerm(e.target.value);\r\n          setValue(e.target.value);\r\n        }}\r\n          disabled={!ready}\r\n          placeholder=\"Enter Address\"\r\n        />\r\n        <ComboboxPopover className=\"list\">\r\n        <ComboboxList>\r\n          <h1 className=\"searchTitles\">Locations</h1>\r\n            {status === \"OK\" &&\r\n              data.map(({id, description}) => (<ul className=\"searchList\"><ComboboxOption className=\"mapresult\" key={id} value={description} /> </ul>\r\n            ))}\r\n          <h1 className=\"searchTitles\">Users</h1>\r\n          <ul className=\"searchList\"> {printUsers} </ul>\r\n          <h1 className=\"searchTitles\">Interests</h1>\r\n          <ul className=\"searchList\"> {printInterest} </ul>\r\n          </ComboboxList>\r\n        </ComboboxPopover>\r\n      </Combobox>\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}