{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\evan_\\\\Documents\\\\GitHub\\\\picshare\\\\src\\\\explore.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { GoogleMap, useLoadScript, Marker, InfoWindow } from \"@react-google-maps/api\";\nimport { formatRelative } from \"date-fns\";\nimport usePlacesAutocomplete, { getGeocode, getLatLng } from \"use-places-autocomplete\";\nimport { Combobox, ComboboxInput, ComboboxPopover, ComboboxList, ComboboxOption } from \"@reach/combobox\";\nimport \"./explore.css\";\nimport { NONAME } from \"dns\";\nimport Axios from 'axios';\nimport Navbar from './components/Navbar/NavBar';\nimport SideDrawer from './components/SideDrawer/SideDrawer';\nimport Backdrop from './components/Backdrop/Backdrop'; //credintials for get, using axios\n\nAxios.defaults.withCredentials = true;\nconst libraries = [\"places\"];\nconst mapContainerStyle = {\n  // set width/height of the map container\n  width: '100vw',\n  height: '100vh'\n};\nconst center = {\n  // set initial position of map\n  lat: 55.909549,\n  lng: -3.318807\n};\nconst options = {\n  disableDefaultUI: true,\n  zoomControl: true\n};\nexport default function Explore() {\n  _s();\n\n  const {\n    isLoaded,\n    loadError\n  } = useLoadScript({\n    googleMapsApiKey: \"AIzaSyAhlnlgHa_2GfJVSbupAcK_aIMxlc7DSoI\",\n    // api key stored in .env.local file\n    libraries\n  });\n  const [markers, setMarkers] = React.useState([]);\n  const [selected, setSelected] = React.useState(null);\n  const [sideDrawer, setSideDrawer] = React.useState(null);\n  const [backDrop, setBackDrop] = React.useState(null);\n  const [sideDrawerOpen, setSideDrawerOpen] = React.useState(false);\n\n  const drawerToggleClick = () => {\n    console.log(sideDrawerOpen);\n    setSideDrawerOpen(!sideDrawerOpen);\n  };\n\n  const backdropClick = () => {\n    setSideDrawerOpen(false);\n  };\n\n  const onMapClick = React.useCallback(event => {\n    // setting event on click of map\n    setMarkers(current => [...current, {\n      lat: event.latLng.lat(),\n      lng: event.latLng.lng(),\n      time: new Date()\n    }]);\n  }, []); // stores events in array\n\n  const mapRef = React.useRef(); //keeping track of reference to map so we can pan\n\n  const onMapLoad = React.useCallback(map => {\n    mapRef.current = map;\n  }, []);\n  const panTo = React.useCallback(({\n    lat,\n    lng\n  }) => {\n    //panning function that takes lat+lng of search selection and pans map to it\n    mapRef.current.panTo({\n      lat,\n      lng\n    });\n    mapRef.current.setZoom(14);\n    panTo({\n      lat,\n      lng\n    });\n  }, []);\n  if (loadError) return \"Error loading maps\";\n  if (!isLoaded) return \"Loading Maps\";\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {\n      drawerClickedHandler: drawerToggleClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 6\n    }, this), sideDrawerOpen ? /*#__PURE__*/_jsxDEV(SideDrawer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this) : null, sideDrawerOpen ? /*#__PURE__*/_jsxDEV(Backdrop, {\n      click: backdropClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }, this) : null, /*#__PURE__*/_jsxDEV(Search, {\n      panTo: panTo\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Locate, {\n      panTo: panTo\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(GoogleMap //map info\n    , {\n      mapContainerStyle: mapContainerStyle,\n      zoom: 15,\n      center: center,\n      options: options,\n      onClick: onMapClick,\n      onLoad: onMapLoad,\n      children: [markers.map(marker => /*#__PURE__*/_jsxDEV(Marker //marker info\n      , {\n        position: {\n          lat: marker.lat,\n          lng: marker.lng\n        },\n        onClick: () => {\n          setSelected(marker);\n        }\n      }, marker.time.toISOString(), false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this)), selected ? /*#__PURE__*/_jsxDEV(InfoWindow, {\n        position: {\n          lat: selected.lat,\n          lng: selected.lng\n        },\n        onCloseClick: () => {\n          setSelected(null);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Example\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Added \", formatRelative(selected.time, new Date())]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Explore, \"6RI2kHXmkRpk7q4o4wxHm2DK+ys=\", false, function () {\n  return [useLoadScript];\n});\n\n_c = Explore;\n\nfunction Locate({\n  panTo\n}) {\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    className: \"Locate\",\n    onClick: () => {\n      navigator.geolocation.getCurrentPosition(position => {\n        panTo({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        });\n      }, () => null);\n    },\n    children: /*#__PURE__*/_jsxDEV(\"img\", {\n      src: \"favicon.ico\",\n      alt: \"locate me\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 10\n  }, this);\n}\n\n_c2 = Locate;\n\nfunction Search({\n  panTo\n}) {\n  _s2();\n\n  const [searchTerm, setSearchTerm] = useState('');\n  const [response, setResponse] = useState([]);\n  const [interests, setInterestList] = useState([]);\n  const filteredInterest = interests.filter(interest => {\n    return interest.toLowerCase().includes(searchTerm);\n  });\n  const printInterest = filteredInterest.slice(0, 10).map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n    className: \"mapresult\",\n    children: [item, \", \"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 5\n  }, this));\n\n  const getInterests = () => {\n    Axios.get('http://localhost:3001/getInterest', {}).then(response => {\n      setResponse(response);\n      initInterests();\n    });\n  };\n\n  const initInterests = () => {\n    setInterestList([]);\n    console.log(response);\n\n    if (typeof response.data !== 'undefined') {\n      for (var i = 0; i < response.data.length; i++) {\n        setInterestList(interests => [...interests, response.data[i].InterestsName]);\n      }\n    }\n  };\n\n  const [Userresponse, setResponseUser] = useState([]);\n  const [users, setUserList] = useState([]);\n  const filteredUsers = users.filter(user => {\n    return user.toLowerCase().includes(searchTerm);\n  });\n  const printUsers = filteredUsers.slice(0, 10).map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n    className: \"mapresult\",\n    children: [\" \", item, \", \"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 226,\n    columnNumber: 3\n  }, this));\n\n  const getUsers = () => {\n    Axios.get('http://localhost:3001/getUsers', {}).then(response => {\n      setResponseUser(response);\n      initUsers();\n    });\n  };\n\n  const initUsers = () => {\n    setUserList([]);\n    console.log(Userresponse);\n\n    if (typeof Userresponse.data !== 'undefined') {\n      for (var i = 0; i < Userresponse.data.length; i++) {\n        setUserList(users => [...users, Userresponse.data[i].Username]);\n      }\n    }\n  };\n\n  const {\n    ready,\n    value,\n    suggestions: {\n      status,\n      data\n    },\n    setValue,\n    clearSuggestions\n  } = usePlacesAutocomplete({\n    requestOptions: {\n      location: {\n        lat: () => 55.909549,\n        lng: () => -3.318807\n      },\n      //setting prefered location suggestions to around HW Campus\n      radius: 100 * 1000\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"search\",\n    children: /*#__PURE__*/_jsxDEV(Combobox, {\n      onSelect: async address => {\n        setValue(address, false);\n        clearSuggestions();\n\n        try {\n          //awaiting a selection to then get its lat+lng for panning\n          const results = await getGeocode({\n            address\n          });\n          const {\n            lat,\n            lng\n          } = await getLatLng(results[0]);\n          panTo({\n            lat,\n            lng\n          });\n        } catch (error) {\n          console.log(\"error!\");\n        }\n      },\n      children: [/*#__PURE__*/_jsxDEV(ComboboxInput, {\n        value: value,\n        onChange: e => {\n          getInterests();\n          getUsers();\n          setSearchTerm(e.target.value);\n          setValue(e.target.value);\n        },\n        disabled: !ready,\n        placeholder: \"Enter Address\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ComboboxPopover, {\n        className: \"list\",\n        children: /*#__PURE__*/_jsxDEV(ComboboxList, {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"searchTitles\",\n            children: \"Locations\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 11\n          }, this), status === \"OK\" && data.map(({\n            id,\n            description\n          }) => /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"searchList\",\n            children: [/*#__PURE__*/_jsxDEV(ComboboxOption, {\n              className: \"mapresult\",\n              value: description\n            }, id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 75\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 48\n          }, this)), /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"searchTitles\",\n            children: \"Users\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"searchList\",\n            children: [\" \", printUsers, \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"searchTitles\",\n            children: \"Interests\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"searchList\",\n            children: [\" \", printInterest, \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 280,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(Search, \"MjQY9HAT265eeXRnGaLOAnTi2rU=\", false, function () {\n  return [usePlacesAutocomplete];\n});\n\n_c3 = Search;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Explore\");\n$RefreshReg$(_c2, \"Locate\");\n$RefreshReg$(_c3, \"Search\");","map":{"version":3,"sources":["C:/Users/evan_/Documents/GitHub/picshare/src/explore.js"],"names":["React","useState","useEffect","GoogleMap","useLoadScript","Marker","InfoWindow","formatRelative","usePlacesAutocomplete","getGeocode","getLatLng","Combobox","ComboboxInput","ComboboxPopover","ComboboxList","ComboboxOption","NONAME","Axios","Navbar","SideDrawer","Backdrop","defaults","withCredentials","libraries","mapContainerStyle","width","height","center","lat","lng","options","disableDefaultUI","zoomControl","Explore","isLoaded","loadError","googleMapsApiKey","markers","setMarkers","selected","setSelected","sideDrawer","setSideDrawer","backDrop","setBackDrop","sideDrawerOpen","setSideDrawerOpen","drawerToggleClick","console","log","backdropClick","onMapClick","useCallback","event","current","latLng","time","Date","mapRef","useRef","onMapLoad","map","panTo","setZoom","marker","toISOString","Locate","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","Search","searchTerm","setSearchTerm","response","setResponse","interests","setInterestList","filteredInterest","filter","interest","toLowerCase","includes","printInterest","slice","item","getInterests","get","then","initInterests","data","i","length","InterestsName","Userresponse","setResponseUser","users","setUserList","filteredUsers","user","printUsers","getUsers","initUsers","Username","ready","value","suggestions","status","setValue","clearSuggestions","requestOptions","location","radius","address","results","error","e","target","id","description"],"mappings":"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","sourcesContent":["import React, {useState, useEffect}       from 'react';\r\nimport { GoogleMap, useLoadScript, Marker, InfoWindow } from \"@react-google-maps/api\";\r\nimport { formatRelative } from \"date-fns\";\r\nimport usePlacesAutocomplete, { getGeocode, getLatLng } from \"use-places-autocomplete\";\r\nimport { Combobox, ComboboxInput, ComboboxPopover, ComboboxList, ComboboxOption } from \"@reach/combobox\";\r\nimport \"./explore.css\"\r\nimport { NONAME } from \"dns\";\r\nimport Axios from 'axios';\r\nimport Navbar from './components/Navbar/NavBar';\r\nimport SideDrawer from './components/SideDrawer/SideDrawer';\r\nimport Backdrop from './components/Backdrop/Backdrop'\r\n//credintials for get, using axios\r\nAxios.defaults.withCredentials = true;\r\n\r\n\r\n\r\n\r\nconst libraries = [\"places\"];\r\nconst mapContainerStyle = { // set width/height of the map container\r\n  width: '100vw',\r\n  height: '100vh',\r\n};\r\nconst center = { // set initial position of map\r\n  lat: 55.909549,\r\n  lng: -3.318807,\r\n};\r\n\r\nconst options = {\r\n  disableDefaultUI: true,\r\n  zoomControl: true,\r\n}\r\n\r\nexport default function Explore() {\r\n\r\n\r\n\r\n\r\n  const { isLoaded, loadError } = useLoadScript({\r\n    googleMapsApiKey: \"AIzaSyAhlnlgHa_2GfJVSbupAcK_aIMxlc7DSoI\", // api key stored in .env.local file\r\n    libraries,\r\n  });\r\n\r\n  const [markers, setMarkers] = React.useState([]);\r\n  const [selected, setSelected] = React.useState(null);\r\n  const [sideDrawer, setSideDrawer] = React.useState(null);\r\n  const [backDrop, setBackDrop] = React.useState(null);\r\n\r\n\r\n  const [sideDrawerOpen, setSideDrawerOpen] = React.useState(false)\r\n\r\n\r\n  const drawerToggleClick = () => {\r\n    console.log(sideDrawerOpen)\r\n    setSideDrawerOpen(!sideDrawerOpen);\r\n  };\r\n\r\n  const backdropClick = () => {\r\n      setSideDrawerOpen(false)\r\n  };\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const onMapClick = React.useCallback((event) => { // setting event on click of map\r\n    setMarkers(current => [...current, {\r\n      lat: event.latLng.lat(),\r\n      lng: event.latLng.lng(),\r\n      time: new Date(),\r\n    }])\r\n  }, []); // stores events in array\r\n\r\n  const mapRef = React.useRef(); //keeping track of reference to map so we can pan\r\n  const onMapLoad = React.useCallback((map) => {\r\n    mapRef.current = map;\r\n  }, []);\r\n\r\n  const panTo = React.useCallback(({lat,lng}) => {  //panning function that takes lat+lng of search selection and pans map to it\r\n    mapRef.current.panTo({lat,lng});\r\n    mapRef.current.setZoom(14);\r\n    panTo({lat,lng});\r\n  }, []);\r\n\r\n\r\n  if (loadError) return \"Error loading maps\";\r\n  if (!isLoaded) return \"Loading Maps\";\r\n\r\n\r\n  return (\r\n\r\n\r\n\r\n  <div>\r\n     <Navbar drawerClickedHandler={drawerToggleClick} />\r\n\r\n      {sideDrawerOpen?\r\n      <SideDrawer />\r\n\r\n      :null }\r\n\r\n    {sideDrawerOpen?\r\n          <Backdrop click={backdropClick} />\r\n\r\n    :null }\r\n\r\n\r\n\r\n    <Search panTo={panTo} />\r\n    <Locate panTo={panTo} />\r\n\r\n    <GoogleMap //map info\r\n      mapContainerStyle={mapContainerStyle}\r\n      zoom={15}\r\n      center={center}\r\n      options={options}\r\n      onClick={onMapClick}\r\n      onLoad={onMapLoad}\r\n    >\r\n      {markers.map((marker) => (\r\n        <Marker //marker info\r\n          key={marker.time.toISOString()}\r\n          position={{ lat: marker.lat, lng: marker.lng }}\r\n          onClick={() => {\r\n            setSelected(marker);\r\n          }}\r\n        />\r\n      ))}\r\n\r\n      {selected ? (\r\n        <InfoWindow\r\n          position={{ lat: selected.lat, lng: selected.lng }}\r\n          onCloseClick={() => {\r\n            setSelected(null);\r\n          }}\r\n        >\r\n          <div>\r\n            <h2>Example</h2>\r\n            <p>Added {formatRelative(selected.time, new Date())}</p>\r\n          </div>\r\n        </InfoWindow>) : null}\r\n\r\n\r\n    </GoogleMap>\r\n  </div>\r\n  );\r\n}\r\n\r\n\r\nfunction Locate ({panTo}){\r\n  return <button className=\"Locate\" onClick={() => {\r\n    navigator.geolocation.getCurrentPosition((position) => {\r\n      panTo({\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude,\r\n      });\r\n    }, () => null);\r\n  }}>\r\n    <img src=\"favicon.ico\" alt=\"locate me\"/>\r\n    </button>\r\n}\r\n\r\n\r\n\r\nfunction Search({panTo}) {\r\n\r\n\r\n\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [response, setResponse] = useState([]);\r\n  const [interests, setInterestList] = useState([]);\r\n\r\n  const filteredInterest =\r\n          interests.filter(interest => {\r\n          return interest.toLowerCase().includes(searchTerm);\r\n      })\r\n\r\n  const printInterest =\r\n\r\n    filteredInterest.slice(0,10).map((item) =>\r\n    <li className=\"mapresult\" >{item}, </li>\r\n\r\n  );\r\n\r\n\r\n\r\n\r\n  const getInterests = () => {\r\n    Axios.get('http://localhost:3001/getInterest', {\r\n\r\n    }).then((response) => {\r\n        setResponse(response);\r\n\r\n        initInterests();\r\n\r\n    })\r\n  }\r\n\r\n\r\n\r\n  const initInterests = () => {\r\n    setInterestList([]);\r\n    console.log(response)\r\n    if(typeof response.data !== 'undefined'){\r\n        for(var i = 0; i < response.data.length; i++){\r\n            setInterestList(interests => [...interests,response.data[i].InterestsName])\r\n        }\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  const [Userresponse, setResponseUser] = useState([]);\r\n  const [users, setUserList] = useState([]);\r\n\r\n  const filteredUsers =\r\n\r\n          users.filter(user => {\r\n          return user.toLowerCase().includes(searchTerm);\r\n      })\r\n\r\n  const printUsers =  filteredUsers.slice(0,10).map((item) =>\r\n  <li className=\"mapresult\" > {item}, </li>\r\n\r\n  );\r\n\r\n  const getUsers = () => {\r\n    Axios.get('http://localhost:3001/getUsers', {\r\n\r\n    }).then((response) => {\r\n        setResponseUser(response);\r\n\r\n        initUsers();\r\n\r\n    })\r\n  }\r\n\r\n\r\n\r\n  const initUsers = () => {\r\n    setUserList([]);\r\n    console.log(Userresponse)\r\n    if(typeof Userresponse.data !== 'undefined'){\r\n        for(var i = 0; i < Userresponse.data.length; i++){\r\n            setUserList(users => [...users,Userresponse.data[i].Username])\r\n        }\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const { ready, value, suggestions: { status, data }, setValue, clearSuggestions } = usePlacesAutocomplete({\r\n    requestOptions: {\r\n      location: { lat: () => 55.909549, lng: () => -3.318807 },   //setting prefered location suggestions to around HW Campus\r\n      radius: 100 * 1000,\r\n    },\r\n  });\r\n\r\n\r\n\r\n  return (\r\n\r\n\r\n    <div className=\"search\">\r\n      <Combobox onSelect={async (address) => {\r\n        setValue(address, false);\r\n        clearSuggestions();\r\n\r\n        try {   //awaiting a selection to then get its lat+lng for panning\r\n          const results = await getGeocode({address});\r\n          const {lat, lng} = await getLatLng(results[0]);\r\n          panTo({lat, lng});\r\n        } catch(error){\r\n          console.log(\"error!\")\r\n        }\r\n        }}\r\n        >\r\n        <ComboboxInput value={value} onChange={(e) => {\r\n          getInterests();\r\n          getUsers();\r\n          setSearchTerm(e.target.value);\r\n          setValue(e.target.value);\r\n        }}\r\n          disabled={!ready}\r\n          placeholder=\"Enter Address\"\r\n        />\r\n        <ComboboxPopover className=\"list\">\r\n        <ComboboxList>\r\n          <h1 className=\"searchTitles\">Locations</h1>\r\n            {status === \"OK\" &&\r\n              data.map(({id, description}) => (<ul className=\"searchList\"><ComboboxOption className=\"mapresult\" key={id} value={description} /> </ul>\r\n            ))}\r\n          <h1 className=\"searchTitles\">Users</h1>\r\n          <ul className=\"searchList\"> {printUsers} </ul>\r\n          <h1 className=\"searchTitles\">Interests</h1>\r\n          <ul className=\"searchList\"> {printInterest} </ul>\r\n          </ComboboxList>\r\n        </ComboboxPopover>\r\n      </Combobox>\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}